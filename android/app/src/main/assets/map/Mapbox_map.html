<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'/>
    <title>Add a vector tile source</title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no'/>
    <script src='./mapbox-gl/mapbox-gl.js'></script>
    <link href='./mapbox-gl/mapbox-gl.css' rel='stylesheet'/>
    <script type="text/javascript" src="webViewBridge.js"></script>
    <link href='customMarker.css' rel='stylesheet'/>

    <style>
        body {
            margin: 0;
            padding: 0;
        }

        #map {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 100%;
        }
    </style>
</head>
<body>

<div id='map'></div>
<script>
	mapboxgl.accessToken = undefined;
	var map = new mapboxgl.Map({
		container: 'map',
		zoom: 16,
		center: [7.2, 52],
		style: 'https://openmaptiles.convotis.com/styles/osm-bright/style.json',
		attributionControl: false,
	});

	var el = document.createElement('div');
	el.className = 'marker-location';

	var marker = new mapboxgl.Marker(el, {anchor: 'bottom'})
		.setLngLat([7.2, 52])
		.setDraggable(true)
		.addTo(map);

	marker.on('dragend', submitMarkerPosition);

	function submitMarkerPosition() {
		webViewBridge.send('userControlledLocation', marker.getLngLat(), (s) => webViewBridge.send('close', s, null, null), null);
	}

</script>

</body>
</html>
